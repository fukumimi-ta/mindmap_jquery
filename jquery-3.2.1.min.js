var svgNS = " http://www.w3.org/TR/SVG";
var htmlNS = "http://www.w3.org/1999/xhtml"

var foreignElement = document.createElementNS(svgNS, "foreignObject");
foreignElement.setAttribute("width", nodeWidth);
foreignElement.setAttribute("height", nodeHeight);
foreignElement.setAttribute("x", x);
foreignElement.setAttribute("y", y);

var innerElement = document.createElementNS(htmlNS, "div");
innerElement.innerText = text;

document.getElementById("map").appendChild(foreignElement);
foreignElement.appendChild(innerElement);